# 機能仕様書: カタログ閲覧機能

**フィーチャーブランチ**: `001-catalog-browse`
**作成日**: 2026-02-27
**ステータス**: Draft
**入力**: ユーザー説明: "カタログ閲覧機能 — 購入者が商品カタログを閲覧できる機能。認証不要で閲覧可能。"

## ユーザーシナリオとテスト *(必須)*

### ユーザーストーリー 1 - 商品一覧を閲覧する（優先度: P1）

購入者として、認証なしでサイトにアクセスし、商品カタログをカード形式（商品画像・商品名・価格・在庫状況）で閲覧できる。12件を超える商品がある場合はページネーションで次ページに移動できる。

**この優先度の理由**: カタログ閲覧機能の基本導線であり、すべての購買行動の起点となる。

**独立テスト**: 商品一覧ページに認証なしでアクセスし、カード表示・ページネーション・在庫切れ表示・商品なし表示が正常に動作することで独立して検証可能。

**受け入れシナリオ**:

1. **Given** 商品が12件以下登録されている状態で、**When** 購入者が商品一覧ページにアクセスすると、**Then** 商品カード（画像・名称・価格・在庫状況）が一覧表示され、ページネーションは表示されない
2. **Given** 商品が13件以上登録されている状態で、**When** 購入者が商品一覧ページにアクセスすると、**Then** 最初の12件が表示され、次のページへのページネーションが表示される
3. **Given** ページネーションが表示されている状態で、**When** 購入者が次ページに移動すると、**Then** 続く商品が表示される
4. **Given** 在庫数が0の商品が存在する状態で、**When** 購入者が商品一覧ページを閲覧すると、**Then** 該当商品カードに「在庫切れ」と表示される
5. **Given** 商品が0件の状態で、**When** 購入者が商品一覧ページにアクセスすると、**Then** 「商品がありません」と表示される

---

### ユーザーストーリー 2 - 商品詳細を確認する（優先度: P2）

購入者として、商品一覧から商品を選択し、詳細ページで商品画像・商品名・価格・説明文・在庫数を確認したうえでカートに追加できる。在庫切れの場合はカート追加ボタンが無効化される。

**この優先度の理由**: 購入判断に必要な情報を提供する画面であり、カート追加のエントリーポイント。ただし一覧表示（P1）が成立した後に機能する。

**独立テスト**: 商品詳細ページに直接URLでアクセスし、全情報の表示・カートボタンの状態・一覧へ戻るナビゲーションが機能することで独立して検証可能。

**受け入れシナリオ**:

1. **Given** 在庫数が1以上の商品詳細ページを開いた状態で、**When** 購入者がページを閲覧すると、**Then** 商品画像・商品名・価格・説明文・在庫数が表示され、カート追加ボタンが有効な状態で表示される
2. **Given** 在庫数が0の商品詳細ページを開いた状態で、**When** 購入者がページを閲覧すると、**Then** カート追加ボタンが無効化（操作不可）されている
3. **Given** 商品画像が未設定の商品詳細ページを開いた状態で、**When** 購入者がページを閲覧すると、**Then** プレースホルダー画像が表示される
4. **Given** 商品詳細ページを閲覧中の状態で、**When** 購入者が「一覧に戻る」ナビゲーションを操作すると、**Then** 商品一覧ページに遷移する

---

### ユーザーストーリー 3 - 商品を検索する（優先度: P3）

購入者として、キーワードを入力して商品名・説明文を検索し、該当する商品のみを絞り込み表示できる。検索条件をクリアすると全商品一覧に戻る。

**この優先度の理由**: 一覧・詳細の閲覧（P1・P2）が成立した後に価値を発揮する補助機能。

**独立テスト**: 検索フォームにキーワードを入力して結果一覧が変化すること、クリア時に全件表示に戻ることを確認することで独立して検証可能。

**受け入れシナリオ**:

1. **Given** 複数の商品が登録されている状態で、**When** 購入者がキーワードを入力して検索すると、**Then** 商品名または説明文にキーワードを含む商品のみが表示される
2. **Given** 検索結果が0件の状態で、**When** 購入者が検索を実行すると、**Then** 「該当する商品が見つかりませんでした」と表示される
3. **Given** 検索条件が入力された状態で、**When** 購入者が検索をクリアすると、**Then** 全商品一覧が表示される

---

### エッジケース

- 商品画像のURLが無効または読み込み失敗の場合、プレースホルダー画像にフォールバックする
- 存在しないページ番号にアクセスした場合、最初のページを表示する
- 非常に長い商品名・価格の場合でもカードレイアウトが崩れないこと

## 要件 *(必須)*

### 機能要件

- **FR-001**: システムは購入者が認証なしで商品一覧ページにアクセスできなければならない（MUST）
- **FR-002**: 商品一覧はカード形式（商品画像・商品名・価格・在庫状況）で表示されなければならない（MUST）
- **FR-003**: 商品一覧は1ページあたり12件を表示し、13件以上の場合はページネーションを提供しなければならない（MUST）
- **FR-004**: 在庫数が0の商品は「在庫切れ」と表示されなければならない（MUST）
- **FR-005**: 商品が0件の場合は「商品がありません」と表示されなければならない（MUST）
- **FR-006**: 購入者は商品一覧から商品を選択して詳細ページに遷移できなければならない（MUST）
- **FR-007**: 商品詳細ページには商品画像・商品名・価格・説明文・在庫数を表示しなければならない（MUST）
- **FR-008**: 在庫数が0の商品のカート追加ボタンは無効化されなければならない（MUST）
- **FR-009**: 商品画像が未設定の場合はプレースホルダー画像を表示しなければならない（MUST）
- **FR-010**: 商品詳細ページから商品一覧に戻るナビゲーションを提供しなければならない（MUST）
- **FR-011**: 購入者はキーワードで商品名・説明文を検索できなければならない（MUST）
- **FR-012**: 検索結果が0件の場合は該当なしのメッセージを表示しなければならない（MUST）
- **FR-013**: 検索条件をクリアすると全商品一覧に戻らなければならない（MUST）

### 主要エンティティ

- **Product（商品）**: 商品ID・商品名・価格・説明文・画像URL（省略可）・在庫数を持つ。カタログAPIを通じて取得する。既存の登録済みデータを参照するのみで、本機能からの登録・更新・削除は行わない。

## 成功基準 *(必須)*

### 測定可能な成果

- **SC-001**: 購入者が認証なしで商品一覧ページに到達できる（ログイン画面にリダイレクトされない）
- **SC-002**: 商品一覧の初回ロードが3秒以内に完了する
- **SC-003**: ページネーションで次のページに移動した際、2秒以内に表示が切り替わる
- **SC-004**: 検索キーワード入力から結果表示まで2秒以内に完了する
- **SC-005**: 在庫切れ商品・商品0件・検索結果0件の各状態が仕様通りに表示される（全パターン確認済み）
- **SC-006**: モバイル・デスクトップ両方の画面幅でカードレイアウトが崩れない
